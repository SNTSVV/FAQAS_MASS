% !TEX root = MAIN.tex

\chapter{Software Overview}
\label{chapter:overview}

\section{Function and Purpose}

The FAQAS activity concerns the investigation of mutation testing as a method to evaluate the quality of software test suites and mutation testing as a method to derive new software test cases.

The \FAQAS shall support a code-driven and data-driven mutation testing methodology that integrates and extends state-of-art solutions. The reference methodology has been described in D2. The methodology enables a scalable and accurate mutation testing process even when the software under test is large and characterized by test suites requiring long execution time.

The end-user of the \FAQAS is a software engineer (i.e., a professional with a master degree in informatics or related fields)  who aims to evaluate the quality of the test suite developed for a flight software component or system. Hereafter, the end-user of \FAQAS is referred to as \emph{the engineer}.

Since \FAQAS implements two distinct features, code-driven mutation testing and data-driven mutation testing, this document contains two separate sections, each one concerning one of the two features: Section~\ref{sec:codeDriven} concerns code-driven mutation testing, Section~\ref{sec:dataDriven} concerns data-driven mutation testing.

The requirements defined in this chapter are univocally identified by the paragraph id appearing on the left.

\section{General Capabilities}

\RQ{} \FAQAS shall support test suite evaluation based on code mutation.

\RQ{} \FAQAS shall support test suite augmentation based on code mutation.

\RQ{} \FAQAS shall support test suite evaluation based on data mutation.

\RQ{} \FAQAS should support test suite augmentation based on data mutation.

\REVISION{P-8 P-13}{\RQ{} \FAQAS shall implement the code-driven test suite evaluation and test suite augmentation steps depicted in Figure~\ref{fig:code:process}. Detailed explanation is provided in D2 Chapter 1.}

\begin{figure}
	\centering
		\includegraphics[width=12cm]{images/process}
		\caption{Code-driven Mutation Testing Process.}
		\label{fig:code:process}
	\end{figure}
	
	
\REVISION{P-8}{\RQ{} \FAQAS shall implement the data-driven test suite evaluation and test suite augmentation steps depicted in Figure~\ref{fig:data:process}. Detailed explanation is provided in D2 Chapter 2.}

\begin{figure}
	\centering
		\includegraphics[width=12cm]{images/dataProcess}
		\caption{Data-driven Mutation Testing Process.}
		\label{fig:data:process}
	\end{figure}	

\clearpage

\section{General Constraints}

\REVISION{P-3}{\RQ{} Test suite evaluation for code-driven mutation testing shall be based on SRCIror\footnote{https://github.com/TestingResearchIllinois/srciror} (detailed motivation is provided in D2).}

\RQ{} The automated generation of test cases (i.e., the objective of test suite augmentation) shall rely on existing tools because it is an open, complex, research problem.

\RQ{} The automated generation of test cases for code-mutation may rely on KLEE, which is the most stable test case generation tool, based on WP2 evaluation.


\section{Software Architecture}

\RQ{} \REVISION{P-4}{\FAQAS shall follow a modular architecture. The FAQAS Architecture is depicted in Figure~\ref{fig:architecture}. The FAQAS system shall consists of four components 
\begin{itemize}
\item MASS (Mutation Analysis for Space Software), which implements test suite evaluation based on code-driven mutation.
\item SEMuS (Symbolic Execution-based Mutation testing for Space), which implements test suite augmentation based on code-driven mutation.
\item DAMA (Data-driven Mutation Analysis), which implements test suite evaluation based on data-driven mutation.
\item DAMTE (DAta-driven Mutation TEsting), which implements test suite augmentation based on data-driven mutation.
\end{itemize}}

\RQ{} \REVISION{P-4}{At high-level, the four \FAQAS components shall work as follows. All the components receive as input the software under test (SUT), the test suite to evaluate (SUT Test Suite), and a set of configurations. MASS generates a set of code-driven mutants, the mutation score, and a list of live mutants. SEMuS receive as input the list of live mutants and generate test cases that kill them. DAMA generates a set of data-driven mutants, the mutation score, and a list of live mutants. DAMTE receive as input the list of live data-driven mutants and generate test cases that kill them.}

\begin{figure}[h]
	\centering
		\includegraphics[width=12cm]{images/Architecture}
		\caption{FAQAS Architecture. Arrows represent data-flow.}
		\label{fig:architecture}
	\end{figure}

\clearpage
\section{Operational Environment}

\RQ{} \REVISION{P-5}{The \FAQAS shall run on any operating system provided that a bash shell and Python 3 are installed on it.}

\RQ{} The \FAQAS shall provide support to work on HPC infrastructure.

\RQ{} The \FAQAS shall be executed on the following minimum hardware specifications: 4 GB RAM and 10 GB of free disk space.

%\RQ{} The \FAQAS shall be executed on a Linux operating system with a Bash shell.

\RQ{} The \FAQAS shall be tested to work on the following Linux distributions: (i) Debian 9, (ii) Ubuntu 16, and (iii) CentOS 7.



\section{Assumptions and dependencies}

\RQ{} The \FAQAS shall process SUT built using either GCC Make~\footnote{https://gcc.gnu.org/onlinedocs/gccint/Makefile.html} or WAF\footnote{https://waf.io/}.

\REVISION{P-7}{\RQ{} The \FAQAS shall process SUT compiled with GCC~\footnote{https://gcc.gnu.org} versions above 4. }
%4.2.1, 5.4.0, and 6.3.0.

\RQ{} The \FAQAS shall process SUT test suites implemented as scripts (hereafter, \emph{test suite script}) that trigger the execution of test cases (each test case is executed in a separate process). Test suite scripts could be implemented either as Makefiles or a Bash scripts. Each test case is executed through the invocation of a command in the script.



\chapter{Requirements}

\section{Functional requirements}
\label{sec:requirements}

\input{codeDriven}
\input{dataDriven}



\section{System interface requirements}

\DONE{Oscar P-15}

\RQ{} The user interface of the \FAQAS is provided through the command line.

\REVISION{P-15a}{\RQ{} The \FAQAS shall use \texttt{gcov}\footnote{https://gcc.gnu.org/onlinedocs/gcc/Gcov.html} to generate and process the code coverage of the SUT.}


\REVISION{P-15c}{\RQ{} The \FAQAS shall support the following commands:
	\begin{itemize}
	\item \texttt{PrepareSUT}: command to prepare the SUT and collect information about the SUT test suite.
	\item \texttt{GenerateMutants}: command to generate mutants from the SUT source code.
	\item \texttt{CompileOptimizedMutants}: command to compile the mutants with the multiple optimisation levels.
	\item \texttt{OptimizedPostProcessing}: command to disregard equivalent and redundant mutants based on compiler optimisations.
	\item \texttt{GeneratePTS}: command to generate the prioritized and reduced test suites.
	\item \texttt{ExecuteMutants}: command to execute mutants against the SUT test suite.
	\item \texttt{IdentifyEquivalents}: command to identify equivalent mutants based on code coverage.
	\item \texttt{MutationScore}: command to compute the mutation score and final reporting.
	\item \texttt{PrepareMutants\_HPC}: command to prepare the mutants workspace for the execution on HPCs.
	\item \texttt{ExecuteMutants\_HPC}: command to execute mutants on HPCs.
	\item \texttt{PostMutation\_HPC}: command to assess past mutant executions, and to decide whether more mutant executions are needed.
\end{itemize}
}

\REVISION{P-15b}{\RQ{} The \FAQAS shall generate the following log files:
	\begin{itemize}
		\item output concerning SUT compilation process
		\item output concerning execution of SUT test cases
		\item output concerning the execution of the \texttt{CompileOptimizedMutants} command
		\item output concerning the execution of the \texttt{OptimizedPostProcessing} command
		\item output concerning the execution of the \texttt{GeneratePTS} command
		\item output concerning the execution of the \texttt{ExecuteMutants} command
		\item output concerning the execution of the \texttt{IdentifyEquivalents} command
		\item output concerning the execution of the \texttt{MutationScore} command
		\item output concerning the execution of the \texttt{PrepareMutants\_HPC} command
		\item output concerning the execution of the \texttt{ExecuteMutants\_HPC} command
		\item output concerning the execution of the \texttt{PostMutation\_HPC} command
	\end{itemize}
}

\REVISION{P-15d}{
\RQ{} The \FAQAS shall be configured through a text file named \texttt{mass\_conf.sh}.

\RQ{} The \FAQAS configuration file shall be set with the following parameters:
	\begin{itemize}
		\item \FAQAS installation path
		\item \FAQAS workspace path
		\item SUT relevant paths (e.g., source code folder, test folder, coverage folder)
		\item SUT compilation command
		\item SUT test case execution command
		\item \FAQAS execution environment mode (i.e., single machine, HPC)
		\item \FAQAS trivial compiler optimisation flags
		\item \FAQAS sampling type
		\item \FAQAS sampling rate
		\item \FAQAS test suite prioritization type
	\end{itemize}
}

\RQ{} \FAQAS shall provide built-in features to process the SUT test harness Google Test\footnote{https://github.com/google/googletest} and the Basic mathematical Library Test Suite (BLTS)\footnote{https://essr.esa.int/project/mlfs-mathematical-library-for-flight-software}.

\REVISION{P-16}{\RQ{} \FAQAS shall provide means to configure its execution with any test harness infrastructure for C/C++ software.}

\RQ{} The \FAQAS shall provide the engineer with the ability to configure the environment variables used to tune the mutation testing process.



\section{Adaptation and missionization requirements}

\RQ{} The \FAQAS shall not be used in mission.

\RQ{} The \FAQAS shall be used in the development environment.




\section{Computer resource requirements}


\RQ{} The \FAQAS shall run on Linux operating systems.



\section{Security requirements }

\RQ{} The \FAQAS shall not use network connections.

\section{Safety requirements}

\RQ{} The \FAQAS shall not be used to assess test cases that are executed with target hardware in the loop, to avoid safety hazards.

\section{Reliability and availability requirements}

\RQ{} The \FAQAS shall work according to its functional specifications every time it is invoked.

% \RQ{} The system is expected to work according to is functional specifications every time it is invoked.

\RQ{} The \FAQAS shall not provide an upper bound for mutation testing execution time.

\remark Mutation testing execution time depends on both the number of mutants to be executed and the duration of the test suite execution, information that cannot be foreseen before execution.

\section{Quality requirements}

\RQ{} Usability. Software engineers shall be able to successfully use the \FAQAS after reading its documentation.

\RQ{} The \FAQAS shall be used in any environment matching the characteristics indicated in this document.

\RQ{} The \FAQAS shall comply with software development standards. The software development process shall follow ECSS guidelines as per SoW.


\section{Design requirements and constraints}

\RQ{} The \FAQAS shall be released with ESA Software Community Licence Permissive â€“ v2.3, as defined at https://essr.esa.int/. Any reused component should be compatible with the abovementioned licence.

\RQ{} The \FAQAS shall be implemented using the bash shell script language, the Python programming language, and the C/C++ programming language.

\RQ{} \FAQAS shall mutate the source code of the SUT not the intermediate representation.


\section{Adaptation and installation requirements}

% - Deployment methods (it is maybe a bit early, but we have to think on the methodology to deploy the tool e.g. compile it, have it delivered with an installer, on a container, etc)

%
\RQ{} The \FAQAS should be installed using an installer software.


\section{Software operations requirements}

\RQ{} The \FAQAS shall be executed at anytime,
%It should be possible to execute the system anytime,
in an environment matching the characteristics indicated in this document.

\section{Software maintenance requirements}

\RQ{} One year maintenance support shall be provided as per SoW.

\section{System and software observability requirements}

\RQ{} The debugging of the \FAQAS shall be possible if and only if
%To enable post-mortem debugging,
all the temporary files generated by the system are kept.

\chapter{Verification, validation and system integration}
 \section{Verification and validation process requirements}

\RQ{} Every mutation operator implemented by the \FAQAS shall be tested by a dedicated unit test case.

\RQ{} Unit test cases shall be executed on a x86-64 desktop PC.

\RQ{} Unit test cases execution time shall not exceed one day.

\RQ{} A system test suite for the Code-Driven Mutation Testing component shall be provided. The Code-Driven Mutation Testing component shall be tested as a whole based on the MLFS case study (see D2).

 \RQ{} The \FAQAS shall enable the correct computation of the mutation score for the FAQAS case study systems indicated in deliverable D2.

 \subsection{Validation approach}

\RQ{} SnT shall perform a preliminary validation of the delivered framework.

\RQ{} FAQAS industry partners shall use the system at their premises to validate it.
